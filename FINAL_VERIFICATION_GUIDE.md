# Chart åº“æœ€ç»ˆéªŒè¯æŒ‡å—

## âœ… å®ŒæˆçŠ¶æ€

æœ¬æ–‡æ¡£å¸®åŠ©æ‚¨éªŒè¯æ‰€æœ‰ä¼˜åŒ–å’Œä¿®å¤æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚

---

## 1. æ„å»ºéªŒè¯ âœ…

### éªŒè¯æ‰€æœ‰åŒ…å·²æˆåŠŸæ„å»º

```bash
cd libraries/chart

# æ£€æŸ¥æ„å»ºäº§ç‰©æ˜¯å¦å­˜åœ¨
ls packages/core/es/index.js       # åº”è¯¥å­˜åœ¨
ls packages/vue/es/index.js        # åº”è¯¥å­˜åœ¨
ls packages/react/es/index.js      # åº”è¯¥å­˜åœ¨
ls packages/lit/es/index.js        # åº”è¯¥å­˜åœ¨
```

### å¦‚æœéœ€è¦é‡æ–°æ„å»º

```bash
# åœ¨ libraries/chart ç›®å½•ä¸‹
cd packages/core; pnpm build
cd ../vue; pnpm build
cd ../react; pnpm build
cd ../lit; pnpm build
```

**é¢„æœŸç»“æœ**: æ‰€æœ‰åŒ…éƒ½åº”è¯¥æˆåŠŸæ„å»ºï¼Œæ— é”™è¯¯ã€‚

---

## 2. ç¤ºä¾‹é¡¹ç›®éªŒè¯

### 2.1 Vanilla JavaScript ç¤ºä¾‹

```bash
cd examples/vanilla-example
pnpm install  # å¦‚æœè¿˜æ²¡å®‰è£…
pnpm dev
```

**è®¿é—®**: http://localhost:9002

**éªŒè¯é¡¹ç›®**:
- âœ… é¡µé¢æ­£å¸¸åŠ è½½ï¼Œæ— æ§åˆ¶å°é”™è¯¯
- âœ… æ˜¾ç¤º 4 ä¸ªå›¾è¡¨
- âœ… åˆ‡æ¢å›¾è¡¨ç±»å‹æ­£å¸¸å·¥ä½œ
- âœ… ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½æ­£å¸¸
- âœ… å¼•æ“åˆ‡æ¢ï¼ˆECharts/VChartï¼‰æ­£å¸¸
- âœ… å®æ—¶æ•°æ®å›¾è¡¨æ¯ 2 ç§’æ›´æ–°
- âœ… åˆ·æ–°æ•°æ®æŒ‰é’®å·¥ä½œæ­£å¸¸
- âœ… å¯¼å‡ºå›¾ç‰‡åŠŸèƒ½æ­£å¸¸
- âœ… æ€§èƒ½ä¿¡æ¯æ˜¾ç¤ºæ­£ç¡®

### 2.2 Vue 3 ç¤ºä¾‹

```bash
cd examples/vue-example
pnpm install  # å¦‚æœè¿˜æ²¡å®‰è£…
pnpm dev
```

**è®¿é—®**: http://localhost:9000

**éªŒè¯é¡¹ç›®**:
- âœ… é¡µé¢æ­£å¸¸åŠ è½½
- âœ… Vue ç»„ä»¶æ­£å¸¸æ¸²æŸ“
- âœ… å›¾è¡¨æ­£å¸¸æ˜¾ç¤º
- âœ… å“åº”å¼æ•°æ®æ›´æ–°æ­£å¸¸
- âœ… æ—  Vue è­¦å‘Šæˆ–é”™è¯¯

### 2.3 React ç¤ºä¾‹

```bash
cd examples/react-example
pnpm install  # å¦‚æœè¿˜æ²¡å®‰è£…
pnpm dev
```

**è®¿é—®**: http://localhost:9001

**éªŒè¯é¡¹ç›®**:
- âœ… é¡µé¢æ­£å¸¸åŠ è½½
- âœ… React ç»„ä»¶æ­£å¸¸æ¸²æŸ“
- âœ… å›¾è¡¨æ­£å¸¸æ˜¾ç¤º
- âœ… Hooks å·¥ä½œæ­£å¸¸
- âœ… æ—  React è­¦å‘Šæˆ–é”™è¯¯

---

## 3. Bug ä¿®å¤éªŒè¯

### 3.1 Chart ç±»å¼‚æ­¥å¤„ç†

**æµ‹è¯•ä»£ç ** (åœ¨æµè§ˆå™¨æ§åˆ¶å°):

```javascript
// åœ¨ vanilla-example ä¸­æµ‹è¯•
const chart1Instance = window.chart1  // å‡è®¾æš´éœ²äº†å®ä¾‹

// å¿«é€Ÿè¿ç»­åˆ‡æ¢ä¸»é¢˜ï¼ˆåº”è¯¥ä¸ä¼šå´©æºƒæˆ–æ³„æ¼ï¼‰
await chart1Instance.setTheme('dark')
await chart1Instance.setTheme('light')
await chart1Instance.setTheme('dark')

// å¿«é€Ÿè¿ç»­æ›´æ–°æ•°æ®ï¼ˆåº”è¯¥æŒ‰é¡ºåºæ‰§è¡Œï¼‰
for (let i = 0; i < 10; i++) {
  chart1Instance.updateData({
    labels: ['A', 'B', 'C'],
    datasets: [{
      data: [Math.random() * 100, Math.random() * 100, Math.random() * 100]
    }]
  })
}
```

**é¢„æœŸç»“æœ**:
- âœ… ä¸ä¼šå‡ºç°å†…å­˜æ³„æ¼è­¦å‘Š
- âœ… ä¸ä¼šæœ‰ç«æ€æ¡ä»¶é”™è¯¯
- âœ… ä¸»é¢˜åˆ‡æ¢å¹³æ»‘
- âœ… æ•°æ®æ›´æ–°æŒ‰é¡ºåºæ‰§è¡Œ

### 3.2 Vue ç»„ä»¶å“åº”å¼

**æµ‹è¯•æ­¥éª¤**:
1. åœ¨ Vue ç¤ºä¾‹ä¸­åˆ‡æ¢å›¾è¡¨ç±»å‹
2. åˆ‡æ¢ä¸»é¢˜å¤šæ¬¡
3. åˆ‡æ¢å¼•æ“å¤šæ¬¡

**é¢„æœŸç»“æœ**:
- âœ… æ— é‡å¤åˆå§‹åŒ–è­¦å‘Š
- âœ… é…ç½®å˜åŒ–æ­£ç¡®è§¦å‘æ›´æ–°
- âœ… æ— ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“

### 3.3 React ç»„ä»¶ä¾èµ–

**æµ‹è¯•æ­¥éª¤**:
1. åœ¨ React ç¤ºä¾‹ä¸­åˆ‡æ¢é…ç½®
2. è§‚å¯Ÿæ§åˆ¶å°

**é¢„æœŸç»“æœ**:
- âœ… é…ç½®å˜åŒ–æ­£ç¡®è§¦å‘æ›´æ–°
- âœ… æ— ç¼ºå°‘ä¾èµ–çš„è­¦å‘Š
- âœ… æ— æ— é™å¾ªç¯

---

## 4. æ€§èƒ½ä¼˜åŒ–éªŒè¯

### 4.1 ç¼“å­˜æ€§èƒ½

åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œæ€§èƒ½æµ‹è¯•ï¼š

```javascript
// æµ‹è¯•å¤§å¯¹è±¡å“ˆå¸Œæ€§èƒ½
const largeData = Array.from({length: 10000}, (_, i) => ({
  id: i,
  value: Math.random() * 100,
  label: `Item ${i}`
}))

console.time('Hash Performance')
// å¤šæ¬¡å“ˆå¸Œåº”è¯¥å¾ˆå¿«
for (let i = 0; i < 100; i++) {
  // å‡è®¾èƒ½è®¿é—® fastHash å‡½æ•°
}
console.timeEnd('Hash Performance')
```

**é¢„æœŸç»“æœ**:
- âœ… å“ˆå¸Œé€Ÿåº¦å¿«ï¼ˆ< 50ms for 100 æ¬¡ï¼‰
- âœ… ä¸»çº¿ç¨‹ä¸é˜»å¡
- âœ… ç¼“å­˜å‘½ä¸­ç‡é«˜

### 4.2 å¯¹è±¡æ± æ€§èƒ½

**è§‚å¯Ÿé¡¹ç›®**:
- âœ… å†…å­˜ä½¿ç”¨ç¨³å®šï¼Œä¸æŒç»­å¢é•¿
- âœ… å¯¹è±¡å¤ç”¨ç‡é«˜
- âœ… GC é¢‘ç‡ä½

### 4.3 å¤§æ•°æ®é›†æµ‹è¯•

åœ¨ vanilla ç¤ºä¾‹ä¸­ï¼Œå›¾è¡¨ 4 å·²ç»å±•ç¤ºäº† 1000 ä¸ªæ•°æ®ç‚¹ï¼š

**éªŒè¯é¡¹ç›®**:
- âœ… æ¸²æŸ“é€Ÿåº¦å¿«ï¼ˆ< 100msï¼‰
- âœ… äº¤äº’æµç•…
- âœ… å†…å­˜å ç”¨åˆç†

---

## 5. å·¥ä½œç©ºé—´ç»“æ„éªŒè¯

### 5.1 æ£€æŸ¥ç›®å½•ç»“æ„

```bash
cd libraries/chart

# æ£€æŸ¥ packages ç»“æ„
ls packages/core/es/
ls packages/core/lib/
ls packages/vue/es/
ls packages/react/es/
ls packages/lit/es/

# æ£€æŸ¥ examples ç»“æ„
ls examples/vanilla-example/
ls examples/vue-example/
ls examples/react-example/
```

**é¢„æœŸç»“æœ**:
- âœ… æ‰€æœ‰åŒ…éƒ½æœ‰ es/ å’Œ lib/ ç›®å½•
- âœ… æ‰€æœ‰ç¤ºä¾‹éƒ½æœ‰å®Œæ•´çš„é¡¹ç›®ç»“æ„
- âœ… æ‰€æœ‰é…ç½®æ–‡ä»¶å­˜åœ¨

### 5.2 éªŒè¯ alias é…ç½®

æŸ¥çœ‹ç¤ºä¾‹çš„ vite.config.tsï¼š

```typescript
// vanilla-example/vite.config.ts
resolve: {
  alias: {
    '@ldesign/chart-core': path.resolve(__dirname, '../../packages/core/es/index.js'),
  }
}
```

**é¢„æœŸç»“æœ**:
- âœ… æ‰€æœ‰ç¤ºä¾‹éƒ½æœ‰æ­£ç¡®çš„ alias é…ç½®
- âœ… å¼€å‘æ—¶èƒ½å®æ—¶é¢„è§ˆæºç ä¿®æ”¹

---

## 6. ç±»å‹æ£€æŸ¥éªŒè¯

```bash
# åœ¨å„ä¸ªåŒ…ç›®å½•ä¸‹è¿è¡Œç±»å‹æ£€æŸ¥
cd packages/core
pnpm tsc --noEmit

cd ../vue
pnpm tsc --noEmit

cd ../react
pnpm tsc --noEmit
```

**é¢„æœŸç»“æœ**:
- âœ… æ— ç±»å‹é”™è¯¯
- âœ… æ‰€æœ‰å¯¼å‡ºç±»å‹æ­£ç¡®

---

## 7. æ•…éšœæ’é™¤

### é—®é¢˜ 1: ç«¯å£è¢«å ç”¨

**è§£å†³æ–¹æ³•**: ä¿®æ”¹ vite.config.ts ä¸­çš„ç«¯å£å·

```typescript
server: {
  port: 9999,  // æ”¹æˆå…¶ä»–ç«¯å£
  host: true
}
```

### é—®é¢˜ 2: åŒ…æœªæ‰¾åˆ°

**è§£å†³æ–¹æ³•**: é‡æ–°æ„å»ºåŒ…

```bash
cd libraries/chart
pnpm build
```

### é—®é¢˜ 3: ä¾èµ–æœªå®‰è£…

**è§£å†³æ–¹æ³•**: é‡æ–°å®‰è£…ä¾èµ–

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•
cd libraries/chart
pnpm install

# åœ¨ç¤ºä¾‹ç›®å½•
cd examples/vanilla-example
pnpm install
```

### é—®é¢˜ 4: TypeScript é”™è¯¯

**è§£å†³æ–¹æ³•**: ç¡®ä¿ TypeScript ç‰ˆæœ¬ä¸€è‡´

```bash
pnpm add -D typescript@^5.3.3
```

---

## 8. å®Œæ•´æ€§æ£€æŸ¥æ¸…å•

### Bug ä¿®å¤
- [x] Chart ç±»å¼‚æ­¥å¤„ç†é—®é¢˜å·²ä¿®å¤
- [x] å®ä¾‹ç®¡ç†å™¨ LRU ç®—æ³•å·²ä¿®å¤
- [x] ç¼“å­˜ç®¡ç†å™¨å®šæ—¶å™¨æ¸…ç†å·²ä¿®å¤
- [x] Vue ç»„ä»¶å“åº”å¼é—®é¢˜å·²ä¿®å¤
- [x] React ç»„ä»¶ä¾èµ–æ•°ç»„å·²ä¿®å¤

### æ€§èƒ½ä¼˜åŒ–
- [x] ç¼“å­˜ç³»ç»Ÿå·²ä¼˜åŒ–ï¼ˆfastHashã€æ¸è¿›å¼å“ˆå¸Œã€é¢„çƒ­ï¼‰
- [x] å¯¹è±¡æ± å·²ä¼˜åŒ–ï¼ˆéªŒè¯ã€åˆ†å±‚ã€è‡ªé€‚åº”ï¼‰

### é¡¹ç›®ç»“æ„
- [x] Vanilla JavaScript ç¤ºä¾‹å·²åˆ›å»º
- [x] æ‰€æœ‰ç¤ºä¾‹é…ç½®ç»Ÿä¸€
- [x] å¼€å‘ç¯å¢ƒçƒ­æ›´æ–°æ­£å¸¸

### æ„å»ºéªŒè¯
- [x] core åŒ…æ„å»ºæˆåŠŸ
- [x] vue åŒ…æ„å»ºæˆåŠŸ
- [x] react åŒ…æ„å»ºæˆåŠŸ
- [x] lit åŒ…æ„å»ºæˆåŠŸ

---

## 9. ä¸‹ä¸€æ­¥

é¡¹ç›®å·²ç»å¯ä»¥æŠ•å…¥ä½¿ç”¨ï¼

### å¼€å‘å·¥ä½œæµ

1. ä¿®æ”¹æºç ï¼š`packages/*/src/`
2. æ„å»ºåŒ…ï¼š`pnpm build`
3. å¯åŠ¨ç¤ºä¾‹éªŒè¯ï¼š`cd examples/xxx && pnpm dev`

### å‘å¸ƒæµç¨‹

```bash
# 1. ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
pnpm test

# 2. æ›´æ–°ç‰ˆæœ¬å·
pnpm version patch  # æˆ– minor/major

# 3. æ„å»ºæ‰€æœ‰åŒ…
pnpm build

# 4. å‘å¸ƒ
pnpm publish --access public
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ä¼˜åŒ–å®ŒæˆæŠ¥å‘Š](./OPTIMIZATION_COMPLETE_REPORT.md)
- [å®Œæˆæ€»ç»“](./ä¼˜åŒ–å®Œæˆæ€»ç»“.md)
- [ç¤ºä¾‹å¯åŠ¨æŒ‡å—](./examples/START_ALL.md)
- [é¡¹ç›®ä¸»é¡µ](./README.md)

---

**éªŒè¯å®Œæˆæ—¥æœŸ**: 2024-10-27  
**ç‰ˆæœ¬**: 2.0.0  
**çŠ¶æ€**: âœ… æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å·²éªŒè¯

